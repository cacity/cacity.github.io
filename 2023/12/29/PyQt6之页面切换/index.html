<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>  · 峰哥Python笔记</title><meta name="description" content=" - 峰哥"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="http://cacity.live/atom.xml" title="峰哥Python笔记"><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="峰哥Python笔记" type="application/atom+xml">
</head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">峰哥Python笔记</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>INDEX</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>ARCHIVES</p></a><ul class="shortcut-icons"><a href="https://github.com/AngryPowman" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="post-container"><div class="post"><article class="post-block"><h1 class="post-title"></h1><div class="post-info">Dec 29, 2023</div><div class="post-content"><p>上次做了  <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/f_7jzVZiqqJG3CD42zupZA">Python PyQt6设计图形界面，实现一个简单的ping功能小软件</a></p>
<p>实现一个简单的功能，ping列表的内容，把ping结果展示，ping不通时会有声音提示。<br><img src="https://mmbiz.qpic.cn/mmbiz_png/HbAkIiaswicK6cMSBL07t5UQyYI5F3zmrzxIs8Dy7ydomUPSm3t4CylP3Qv1IpGHlQkYuhnUoDNHV3xl6qTm6Rjw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1"></p>
<p>这个页面是<code>QWidget</code>页面，不能提供更多的窗口和功能，今天把<code>QWidget</code>改成<code>QMainWindow</code>，<code>QMainWindow</code>可以增加菜单，和状态栏等功能，可以在窗口内加<code>QWidget</code>页面。在此窗口基础上，添加几个页面，底部几个按钮(<code>PushButton</code>)相当于页面标签，进行切换使用。下面的三个按钮，只有第一个做了关联，其他两个按钮直接显示一个标签(<code>QLabel</code>)，实现后大概如图：</p>
<p><img src="https://files.mdnice.com/user/38447/402139b0-5719-4aa5-a519-85117e446188.png"></p>
<p><img src="https://files.mdnice.com/user/38447/2b6810ee-3e68-4e8d-b7fd-c3e970ae12dd.png"></p>
<p><img src="https://files.mdnice.com/user/38447/86bab1b4-ea85-4974-8c99-b1b30c9609a3.png"></p>
<p>页面切换使用<code>QStackedWidget</code>,<code>QStackedWidget</code>可以填中多个页面，通过<code>setCurrentIndex(0)</code>来设置激活那个页面。每一个页面的按钮不能共用，实际上是三个页面，每个页面有3个按钮，每个页面有2个按钮的动作做了关联。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">self.button1_2.clicked.connect(self.show_layout2)</span><br><span class="line">self.button1_3.clicked.connect(self.show_layout3)</span><br><span class="line"></span><br><span class="line">self.button2_1.clicked.connect(self.show_layout1)</span><br><span class="line">self.button2_3.clicked.connect(self.show_layout3)</span><br><span class="line"></span><br><span class="line">self.button3_1.clicked.connect(self.show_layout1)</span><br><span class="line">self.button3_2.clicked.connect(self.show_layout2)</span><br></pre></td></tr></table></figure>

<p>切换页面代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def show_layout1(self):</span><br><span class="line">    self.central_widget.setCurrentIndex(0)</span><br><span class="line">    self.statusBar().showMessage(&#x27;仪器设备连通扫描&#x27;)</span><br></pre></td></tr></table></figure>

<p>实现这个功能应该有更好的方案，这个也不算是正经的页面标签页。为了实现这个功能，重复代码一堆。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">self.central_widget = QStackedWidget()</span><br><span class="line">self.setCentralWidget(self.central_widget)</span><br><span class="line"></span><br><span class="line">self.layout1 = QVBoxLayout()</span><br><span class="line">self.layout2 = QVBoxLayout()</span><br><span class="line">self.layout3 = QVBoxLayout()</span><br><span class="line"></span><br><span class="line">self.widget1 = QWidget()</span><br><span class="line">self.widget2 = QWidget()</span><br><span class="line">self.widget3 = QWidget()</span><br><span class="line"></span><br><span class="line">self.widget1.setLayout(self.layout1)</span><br><span class="line">self.widget2.setLayout(self.layout2)</span><br><span class="line">self.widget3.setLayout(self.layout3)</span><br><span class="line"></span><br><span class="line">self.central_widget.addWidget(self.widget1)</span><br><span class="line">self.central_widget.addWidget(self.widget2)</span><br><span class="line">self.central_widget.addWidget(self.widget3)</span><br></pre></td></tr></table></figure>
<p>layout1、2、3对应这三个页面，后面再写代码，填另组件，直接填加即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.layout1.addWidget(self.table_widget)</span><br><span class="line">self.layout1.addLayout(hbox_layout1)</span><br></pre></td></tr></table></figure>

<p>另外我还想实现些汇图功能，可能通过PyQt6与Matplotlib结合，实现绘图。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">from PyQt6 import (</span><br><span class="line">    QtCore,</span><br><span class="line">    QtWidgets,</span><br><span class="line">)  # import PyQt6 before matplotlib</span><br><span class="line"></span><br><span class="line">import matplotlib</span><br><span class="line">import pandas as pd</span><br><span class="line">from matplotlib.backends.backend_qtagg import FigureCanvasQTAgg</span><br><span class="line">from matplotlib.backends.backend_qtagg import (</span><br><span class="line">    NavigationToolbar2QT as NavigationToolbar,</span><br><span class="line">)</span><br><span class="line">from matplotlib.figure import Figure</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matplotlib.use(&quot;QtAgg&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MplCanvas(FigureCanvasQTAgg):</span><br><span class="line">    def __init__(self, parent=None, width=5, height=4, dpi=100):</span><br><span class="line">        fig = Figure(figsize=(width, height), dpi=dpi)</span><br><span class="line">        self.axes = fig.add_subplot(111)</span><br><span class="line">        super().__init__(fig)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MainWindow(QtWidgets.QMainWindow):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line"></span><br><span class="line">        # Create the maptlotlib FigureCanvasQTAgg object,</span><br><span class="line">        # which defines a single set of axes as self.axes.</span><br><span class="line">        sc = MplCanvas(self, width=5, height=4, dpi=100)</span><br><span class="line"></span><br><span class="line">        # Create our pandas DataFrame with some simple</span><br><span class="line">        # data and headers.</span><br><span class="line">        df = pd.DataFrame(</span><br><span class="line">            [</span><br><span class="line">                [0, 10],</span><br><span class="line">                [5, 15],</span><br><span class="line">                [2, 20],</span><br><span class="line">                [15, 25],</span><br><span class="line">                [4, 10],</span><br><span class="line">            ],</span><br><span class="line">            columns=[&quot;A&quot;, &quot;B&quot;],</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        # plot the pandas DataFrame, passing in the</span><br><span class="line">        # matplotlib Canvas axes.</span><br><span class="line">        df.plot(ax=sc.axes)</span><br><span class="line"></span><br><span class="line">        # Create toolbar, passing canvas as first parameter, parent (self, the MainWindow) as second.</span><br><span class="line">        toolbar = NavigationToolbar(sc, self)</span><br><span class="line"></span><br><span class="line">        layout = QtWidgets.QVBoxLayout()</span><br><span class="line">        layout.addWidget(toolbar)</span><br><span class="line">        layout.addWidget(sc)</span><br><span class="line"></span><br><span class="line">        # Create a placeholder widget to hold our toolbar and canvas.</span><br><span class="line">        widget = QtWidgets.QWidget()</span><br><span class="line">        widget.setLayout(layout)</span><br><span class="line">        self.setCentralWidget(widget)</span><br><span class="line">        self.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = QtWidgets.QApplication(sys.argv)</span><br><span class="line">w = MainWindow()</span><br><span class="line">app.exec()</span><br></pre></td></tr></table></figure>

<p><img src="https://files.mdnice.com/user/38447/b8f71eb1-abb5-430d-bf39-58a82833efae.png"></p>
<p>有了这些基础，还有更多玩法。</p>
</div></article></div><div id="disqus_thread"></div></div><script>var disqus_shortname = 'angrypowman';
var disqus_identifier = '2023/12/29/PyQt6之页面切换/';
var disqus_title = '';
var disqus_url = 'http://cacity.live/2023/12/29/PyQt6之页面切换/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//angrypowman.disqus.com/count.js" async></script></main><footer class="footer-container"><div class="paginator"><a href="/2023/12/29/%E5%9F%BA%E4%BA%8E%20Python%20%E7%9A%84%E5%9C%B0%E7%90%83%E7%89%A9%E7%90%86%E5%8F%B0%E7%BD%91%E6%95%B0%E6%8D%AE%E8%B4%A8%E9%87%8F%E7%9B%91%E6%8E%A7%E6%97%A5%E6%8A%A5%E8%87%AA%E5%8A%A8%E5%8C%96%E5%A4%84%E7%90%86%E4%B8%8E%E5%8F%8D%E9%A6%88%E7%94%9F%E6%88%90/" class="prev">PREV</a><a href="/2023/12/29/PyQt6%E4%B9%8B%E7%AE%80%E6%98%93%E8%AE%A1%E7%AE%97%E5%99%A8%E5%92%8C%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 - 2023 <a href="http://cacity.live">峰哥</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"angrypowman",'auto');ga('send','pageview');</script></body></html>